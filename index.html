<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QuizPilot â€¢ Login</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <div class="container">
    <h2>QuizPilot Login</h2>
    <form id="loginForm">
      <input id="username" type="text" placeholder="Username" required />
      <input id="password" type="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
    <div id="error" class="error"></div>
  </div>

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbyXw3Ya3W-6ruru6EMsf66dqIIDCgdAGD_iSdqyPya8sgJ6yPY8LOjSbCYyBEPlJGrI/exec';

    function handleLogin(res) {
      if (res.success) {
        sessionStorage.setItem('user', res.username || res.user);
        sessionStorage.setItem('role', res.role);
        sessionStorage.setItem('class', res.class);
        window.location = res.role === 'teacher' ? 'teacher.html' : 'quiz.html';
      } else {
        document.getElementById('error').textContent = 'Login failed';
      }
    }

    document.getElementById('loginForm').onsubmit = e => {
      e.preventDefault();
      const u = encodeURIComponent(document.getElementById('username').value);
      const p = encodeURIComponent(document.getElementById('password').value);
      const script = document.createElement('script');
      script.src = `${API_URL}?action=login&username=${u}&password=${p}&jsonpCallback=handleLogin`;
      document.body.appendChild(script);
    };
  </script>
</body>
</html>
